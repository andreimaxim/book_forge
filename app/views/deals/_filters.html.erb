<div class="mb-6 bg-white rounded-lg shadow p-4">
  <%= form_with url: deals_path, method: :get, class: "flex flex-wrap gap-4 items-end" do |form| %>
    <% if @view_mode == "pipeline" %>
      <input type="hidden" name="view" value="pipeline">
    <% end %>

    <div class="flex-1 min-w-[200px]">
      <%= form.label :search, "Search", class: "block text-sm font-medium text-gray-700 mb-1" %>
      <%= form.text_field :search,
        value: params[:search],
        placeholder: "Search by book title or author...",
        class: "w-full rounded-md border-gray-300 py-2 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm" %>
    </div>

    <div class="min-w-[150px]">
      <%= form.label :status, "Status", class: "block text-sm font-medium text-gray-700 mb-1" %>
      <%= form.select :status,
        deal_status_options(include_all: true),
        { selected: params[:status] },
        class: "w-full rounded-md border-gray-300 py-2 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm" %>
    </div>

    <div class="min-w-[150px]">
      <%= form.label :deal_type, "Deal Type", class: "block text-sm font-medium text-gray-700 mb-1" %>
      <%= form.select :deal_type,
        deal_type_options(include_all: true),
        { selected: params[:deal_type] },
        class: "w-full rounded-md border-gray-300 py-2 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm" %>
    </div>

    <div class="min-w-[150px]">
      <%= form.label :publisher_id, "Publisher", class: "block text-sm font-medium text-gray-700 mb-1" %>
      <%= form.select :publisher_id,
        [["All Publishers", ""]] + Publisher.active.alphabetical.map { |p| [p.name, p.id] },
        { selected: params[:publisher_id] },
        class: "w-full rounded-md border-gray-300 py-2 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm" %>
    </div>

    <div class="min-w-[130px]">
      <%= form.label :start_date, "From Date", class: "block text-sm font-medium text-gray-700 mb-1" %>
      <%= form.date_field :start_date,
        value: params[:start_date],
        class: "w-full rounded-md border-gray-300 py-2 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm" %>
    </div>

    <div class="min-w-[130px]">
      <%= form.label :end_date, "To Date", class: "block text-sm font-medium text-gray-700 mb-1" %>
      <%= form.date_field :end_date,
        value: params[:end_date],
        class: "w-full rounded-md border-gray-300 py-2 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm" %>
    </div>

    <div class="flex gap-2">
      <%= form.submit "Filter", class: "inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 cursor-pointer" %>
      <% if params[:search].present? || params[:status].present? || params[:deal_type].present? || params[:publisher_id].present? || params[:start_date].present? || params[:end_date].present? %>
        <%= link_to "Clear", @view_mode == "pipeline" ? deals_path(view: "pipeline") : deals_path, class: "inline-flex items-center px-4 py-2 border border-gray-300 text-sm font-medium rounded-md shadow-sm text-gray-700 bg-white hover:bg-gray-50" %>
      <% end %>
    </div>
  <% end %>
</div>
